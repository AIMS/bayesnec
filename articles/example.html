<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>General usage • bayesnec</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/yeti/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="General usage">
<meta property="og:description" content="bayesnec">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">bayesnec</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/example.html">General usage</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/aims/bayesnec/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="example_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>General usage</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/aims/bayesnec/blob/master/vignettes/example.Rmd"><code>vignettes/example.Rmd</code></a></small>
      <div class="hidden name"><code>example.Rmd</code></div>

    </div>

    
    
<div id="bayesnec" class="section level1">
<h1 class="hasAnchor">
<a href="#bayesnec" class="anchor"></a><code>bayesnec</code>
</h1>
<p>The <code>bayesnec</code> is an R package to fit concentration(dose) - response curves to toxicity data, and derive No-Effect-Concentration (<em>NEC</em>), No-Significant-Effect-Concentration (<em>NSEC</em>), and Effect-Concentration (of specified percentage ‘x’, <em>ECx</em>) thresholds from non-linear models fitted using Bayesian MCMC fitting methods via <code>brms</code> <span class="citation">[@Burkner2017; @Burkner2018]</span> and <code>stan</code>. The package is an adaptation and extension of an initial package <code>jagsNEC</code> <span class="citation">[@Fisher2020]</span> which as based on the <code>R2jags</code> package <span class="citation">[@Su2015]</span> and <code>jags</code> <span class="citation">[@Plummer2003]</span>.</p>
</div>
<div id="background" class="section level1">
<h1 class="hasAnchor">
<a href="#background" class="anchor"></a>Background</h1>
<p>Bayesian model fitting can be difficult to automate across a broad range of usage cases, particularly with respect to specifying valid initial values and appropriate priors. This is one reason the use of Bayesian statistics for <em>NEC</em> estimation (or even <em>ECx</em> estimation) is not currently widely adopted across the broader ecotoxicological community, who rarely have access to specialist statistical expertise. The <code>bayesnec</code> package provides an accessible interface specifically for fitting <em>NEC</em> models and other concentration-response models using Bayesian methods. A range of models are specified based on the known distribution of the “concentration” or “dose” variable (the predictor, x) as well as the “response” (y) variable. The model formula, including priors and initial values required to call a <code>brms</code> model are automatically generated based on information contained in the supplied data. While the distribution of the x and y variables can be specified directly, <code>bayesnec</code> will automatically ‘guess’ the correct distribution to use based on the characteristics of the provided data.</p>
<p>This project started with an implementation of the <em>NEC</em> model based on that described in <span class="citation">[@Fox2010]</span> using R2jags. The package has been further generalised to allow a large range of response variables to be modelled using the appropriate statistical distribution. While the original <code>jagsNEC</code> implementation supported gaussian, poisson, binomial, gamma, negbin and beta response data <code>bayesnec</code> supports any of the <code>brms</code> families. We have since also further added a range of alternative <em>NEC</em> model types, as well as a range of typically used concentration-response models (such as 4-parameter logistic and weibull models) that have no <em>NEC</em> ‘step’ function but simply model the response as a smooth function of concentration, as can be fit using other commonly used frequentist packages such as <code>drc</code> <span class="citation">[@Ritz2016]</span>.</p>
<p>Specific models can be fit directly using <code>bnec</code>. Alternatively it is possible to fit a a custom model set, specific model set or all of the available models. When multiple models are specified the <code>bnec</code> function returns a model weighted estimate of predicted posterior values, based on watanabe information criteria (WAIC) model weights, analogous to the way model weights are generated using AIC or AICc <span class="citation">[@Burnham2002]</span>. It is also possible to obtain all individual model fits from the fitted <code>bayesnecfit</code> model object if required. Multi-model inference can be useful where there are a range of plausible models that could be used <span class="citation">[@Burnham2002]</span> and has been recently adopted in ecotoxicology for SSD model inference <span class="citation">[@Thorley2018]</span>.</p>
<p>An additional endpoint has also been derived using Bayesian posterior predicted values to estimate the “No-Statistical-Effect-Concentration” as the concentration at which predicted values for each MCMC chain fall below a lower percentile bound (defined as <code>sig_val</code>) of the control, which is assumed to be the lowest treatment (x_var) concentration in the data. <em>NSEC</em> estimates are currently used to approximate <em>NEC</em> for models without a specific <em>NEC</em> step parameter (in <code>bayesnec</code> these have the prefix <code>ecx</code> in their model name).</p>
<p>Important information on the current package is contained in the <code>bayesnec</code> helpfiles.</p>
<p>This package is currently under development. We are keen on any feedback regarding usage, and especially bug reporting that includes an easy to run self contained reproducible example of unexpected behaviour or example model fits that fail to converge (have poor chain mixing) or yield other errors. Such information will hopefully help us towards building a more robust package. We cannot help troubleshoot issues if an easy to run reproducible example is not supplied.</p>
</div>
<div id="installation" class="section level1">
<h1 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h1>
<p>To install the latest version from github (<a href="https://github.com/AIMS/bayesnec" class="uri">https://github.com/AIMS/bayesnec</a>) use:</p>
<div class="sourceCode" id="cb1"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span>(<span class="st">"remotes"</span>)
<span class="kw">remotes</span>::<span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html">install_github</a></span>(<span class="st">"AIMS/bayesnec"</span>)
</pre></div>
</div>
<div id="examples" class="section level1">
<h1 class="hasAnchor">
<a href="#examples" class="anchor"></a>Examples</h1>
<div id="fitting-the-nec3param-model-using-bnec" class="section level2">
<h2 class="hasAnchor">
<a href="#fitting-the-nec3param-model-using-bnec" class="anchor"></a>Fitting the nec3param model using <code>bnec</code>
</h2>
<p>Here we include some examples showing how to use the package to fit an <em>NEC</em> model to binomial, proportional, count and continuous response (y) data. The examples are those used by Gerard Ricardo at: <a href="https://github.com/gerard-ricardo/NECs/blob/master/NECs" class="uri">https://github.com/gerard-ricardo/NECs/blob/master/NECs</a>. Here we show how to run the same <code>jags</code> models using the <code>bayesnec</code> package.</p>
<div id="binomial-data" class="section level3">
<h3 class="hasAnchor">
<a href="#binomial-data" class="anchor"></a>Binomial data</h3>
<p>Where data are a count out of a total (such as the percentage survival of individuals, for example) y is binomial. First we read in the binomial example from pastebin, and then plot the “concentration” or x data, in this case raw.x.</p>
<div class="sourceCode" id="cb2"><pre class="downlit">
<span class="kw">binom.data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.table</a></span>(<span class="st">"https://pastebin.com/raw/zfrUha88"</span>, header = <span class="fl">TRUE</span>, dec = <span class="st">","</span>)
<span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span>(<span class="kw">binom.data</span>)
<span class="co">#&gt; 'data.frame':    48 obs. of  3 variables:</span>
<span class="co">#&gt;  $ raw.x: chr  "0.1" "0.1" "0.1" "0.1" ...</span>
<span class="co">#&gt;  $ suc  : int  101 106 102 112 58 158 95 91 93 113 ...</span>
<span class="co">#&gt;  $ tot  : int  175 112 103 114 69 165 109 92 99 138 ...</span>
<span class="kw">binom.data</span><span class="op">$</span><span class="kw">raw.x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span>(<span class="kw">binom.data</span><span class="op">$</span><span class="kw">raw.x</span>))
<span class="fu"><a href="https://rdrr.io/r/base/range.html">range</a></span>(<span class="kw">binom.data</span><span class="op">$</span><span class="kw">raw.x</span>)
<span class="co">#&gt; [1]   0.1 400.0</span>
</pre></div>
<p>In this case for x, lowest concentration is 0.1 and the highest is 400. The data are right skewed and on the continuous scale. This type of distribution for the x data are common for concentration response experiments, where the x “concentration” data are the concentration of contaminants, or dilutions. The current default in <code>bayesnec</code> is to estimate the appropriate distribution(s) and priors for both the <code>y_type</code> and <code>x_type</code> arguments, but it is possible to supply these arguments directly.</p>
<p>The data are clearly binomial, with the header “suc” - indicating the number of ‘successes’ in the binomial call, with ‘tot’ clearly indicating the number of trials.</p>
<p>The main ‘working’ function in <code>bayesnec</code> is the function <code>bnec</code>, which calls the other necessary functions and fits the <code>brms</code> model. We run <code>bnec</code> by supplying <code>data</code> - a data.frame containing the data for the model fitting, here, binom.data; <code>x_var</code> - the name of the column in <code>data</code> which contains the concentration data or ‘x’ data to be used in the <em>NEC</em> model fit, and <code>y_var</code> - the name of the column in <code>data</code> which contains the response or ‘y’ data to be used in the <em>NEC</em> model fit. In our example here, as this is binomial, we must also supply <code>trials_var</code>, which is the name of the column in <code>data</code> which contains the number of trials in the binomial call.</p>
<p><code>bnec</code> will guess the data types for use, although we could manually specify <code>y_type</code> as “binomial” and <code>x_type</code> as “gamma”. This example fits without specifying either, but <code>trials_var</code> must be supplied.</p>
<div class="sourceCode" id="cb3"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="kw"><a href="https://aims.github.io/bayesnec">bayesnec</a></span>)
<span class="co">#&gt; Loading required package: brms</span>
<span class="co">#&gt; Loading required package: Rcpp</span>
<span class="co">#&gt; Loading 'brms' package (version 2.13.5). Useful instructions</span>
<span class="co">#&gt; can be found by typing help('brms'). A more detailed introduction</span>
<span class="co">#&gt; to the package is available through vignette('brms_overview').</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Attaching package: 'brms'</span>
<span class="co">#&gt; The following object is masked from 'package:stats':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     ar</span>

<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="fl">333</span>)
<span class="kw">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bnec.html">bnec</a></span>(
  data = <span class="kw">binom.data</span>,
  x_var = <span class="st">"raw.x"</span>,
  y_var = <span class="st">"suc"</span>,
  model = <span class="st">"nec3param"</span>,
  trials_var = <span class="st">"tot"</span>
)
<span class="co">#&gt; Compiling Stan program...</span>
<span class="co">#&gt; Start sampling</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; SAMPLING FOR MODEL 'b219b9b3bc2387c567eef001e65b92c9' NOW (CHAIN 1).</span>
<span class="co">#&gt; Chain 1: </span>
<span class="co">#&gt; Chain 1: Gradient evaluation took 7.6e-05 seconds</span>
<span class="co">#&gt; Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 0.76 seconds.</span>
<span class="co">#&gt; Chain 1: Adjust your expectations accordingly!</span>
<span class="co">#&gt; Chain 1: </span>
<span class="co">#&gt; Chain 1: </span>
<span class="co">#&gt; Chain 1: Iteration:     1 / 20000 [  0%]  (Warmup)</span>
<span class="co">#&gt; Chain 1: Iteration:  2000 / 20000 [ 10%]  (Warmup)</span>
<span class="co">#&gt; Chain 1: Iteration:  4000 / 20000 [ 20%]  (Warmup)</span>
<span class="co">#&gt; Chain 1: Iteration:  6000 / 20000 [ 30%]  (Warmup)</span>
<span class="co">#&gt; Chain 1: Iteration:  8000 / 20000 [ 40%]  (Warmup)</span>
<span class="co">#&gt; Chain 1: Iteration: 10000 / 20000 [ 50%]  (Warmup)</span>
<span class="co">#&gt; Chain 1: Iteration: 12000 / 20000 [ 60%]  (Warmup)</span>
<span class="co">#&gt; Chain 1: Iteration: 14000 / 20000 [ 70%]  (Warmup)</span>
<span class="co">#&gt; Chain 1: Iteration: 16000 / 20000 [ 80%]  (Warmup)</span>
<span class="co">#&gt; Chain 1: Iteration: 16001 / 20000 [ 80%]  (Sampling)</span>
<span class="co">#&gt; Chain 1: Iteration: 18000 / 20000 [ 90%]  (Sampling)</span>
<span class="co">#&gt; Chain 1: Iteration: 20000 / 20000 [100%]  (Sampling)</span>
<span class="co">#&gt; Chain 1: </span>
<span class="co">#&gt; Chain 1:  Elapsed Time: 5.74529 seconds (Warm-up)</span>
<span class="co">#&gt; Chain 1:                0.899998 seconds (Sampling)</span>
<span class="co">#&gt; Chain 1:                6.64529 seconds (Total)</span>
<span class="co">#&gt; Chain 1: </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; SAMPLING FOR MODEL 'b219b9b3bc2387c567eef001e65b92c9' NOW (CHAIN 2).</span>
<span class="co">#&gt; Chain 2: </span>
<span class="co">#&gt; Chain 2: Gradient evaluation took 3.7e-05 seconds</span>
<span class="co">#&gt; Chain 2: 1000 transitions using 10 leapfrog steps per transition would take 0.37 seconds.</span>
<span class="co">#&gt; Chain 2: Adjust your expectations accordingly!</span>
<span class="co">#&gt; Chain 2: </span>
<span class="co">#&gt; Chain 2: </span>
<span class="co">#&gt; Chain 2: Iteration:     1 / 20000 [  0%]  (Warmup)</span>
<span class="co">#&gt; Chain 2: Iteration:  2000 / 20000 [ 10%]  (Warmup)</span>
<span class="co">#&gt; Chain 2: Iteration:  4000 / 20000 [ 20%]  (Warmup)</span>
<span class="co">#&gt; Chain 2: Iteration:  6000 / 20000 [ 30%]  (Warmup)</span>
<span class="co">#&gt; Chain 2: Iteration:  8000 / 20000 [ 40%]  (Warmup)</span>
<span class="co">#&gt; Chain 2: Iteration: 10000 / 20000 [ 50%]  (Warmup)</span>
<span class="co">#&gt; Chain 2: Iteration: 12000 / 20000 [ 60%]  (Warmup)</span>
<span class="co">#&gt; Chain 2: Iteration: 14000 / 20000 [ 70%]  (Warmup)</span>
<span class="co">#&gt; Chain 2: Iteration: 16000 / 20000 [ 80%]  (Warmup)</span>
<span class="co">#&gt; Chain 2: Iteration: 16001 / 20000 [ 80%]  (Sampling)</span>
<span class="co">#&gt; Chain 2: Iteration: 18000 / 20000 [ 90%]  (Sampling)</span>
<span class="co">#&gt; Chain 2: Iteration: 20000 / 20000 [100%]  (Sampling)</span>
<span class="co">#&gt; Chain 2: </span>
<span class="co">#&gt; Chain 2:  Elapsed Time: 5.60656 seconds (Warm-up)</span>
<span class="co">#&gt; Chain 2:                0.933394 seconds (Sampling)</span>
<span class="co">#&gt; Chain 2:                6.53996 seconds (Total)</span>
<span class="co">#&gt; Chain 2: </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; SAMPLING FOR MODEL 'b219b9b3bc2387c567eef001e65b92c9' NOW (CHAIN 3).</span>
<span class="co">#&gt; Chain 3: </span>
<span class="co">#&gt; Chain 3: Gradient evaluation took 3.7e-05 seconds</span>
<span class="co">#&gt; Chain 3: 1000 transitions using 10 leapfrog steps per transition would take 0.37 seconds.</span>
<span class="co">#&gt; Chain 3: Adjust your expectations accordingly!</span>
<span class="co">#&gt; Chain 3: </span>
<span class="co">#&gt; Chain 3: </span>
<span class="co">#&gt; Chain 3: Iteration:     1 / 20000 [  0%]  (Warmup)</span>
<span class="co">#&gt; Chain 3: Iteration:  2000 / 20000 [ 10%]  (Warmup)</span>
<span class="co">#&gt; Chain 3: Iteration:  4000 / 20000 [ 20%]  (Warmup)</span>
<span class="co">#&gt; Chain 3: Iteration:  6000 / 20000 [ 30%]  (Warmup)</span>
<span class="co">#&gt; Chain 3: Iteration:  8000 / 20000 [ 40%]  (Warmup)</span>
<span class="co">#&gt; Chain 3: Iteration: 10000 / 20000 [ 50%]  (Warmup)</span>
<span class="co">#&gt; Chain 3: Iteration: 12000 / 20000 [ 60%]  (Warmup)</span>
<span class="co">#&gt; Chain 3: Iteration: 14000 / 20000 [ 70%]  (Warmup)</span>
<span class="co">#&gt; Chain 3: Iteration: 16000 / 20000 [ 80%]  (Warmup)</span>
<span class="co">#&gt; Chain 3: Iteration: 16001 / 20000 [ 80%]  (Sampling)</span>
<span class="co">#&gt; Chain 3: Iteration: 18000 / 20000 [ 90%]  (Sampling)</span>
<span class="co">#&gt; Chain 3: Iteration: 20000 / 20000 [100%]  (Sampling)</span>
<span class="co">#&gt; Chain 3: </span>
<span class="co">#&gt; Chain 3:  Elapsed Time: 5.72365 seconds (Warm-up)</span>
<span class="co">#&gt; Chain 3:                0.937822 seconds (Sampling)</span>
<span class="co">#&gt; Chain 3:                6.66147 seconds (Total)</span>
<span class="co">#&gt; Chain 3: </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; SAMPLING FOR MODEL 'b219b9b3bc2387c567eef001e65b92c9' NOW (CHAIN 4).</span>
<span class="co">#&gt; Chain 4: </span>
<span class="co">#&gt; Chain 4: Gradient evaluation took 3.6e-05 seconds</span>
<span class="co">#&gt; Chain 4: 1000 transitions using 10 leapfrog steps per transition would take 0.36 seconds.</span>
<span class="co">#&gt; Chain 4: Adjust your expectations accordingly!</span>
<span class="co">#&gt; Chain 4: </span>
<span class="co">#&gt; Chain 4: </span>
<span class="co">#&gt; Chain 4: Iteration:     1 / 20000 [  0%]  (Warmup)</span>
<span class="co">#&gt; Chain 4: Iteration:  2000 / 20000 [ 10%]  (Warmup)</span>
<span class="co">#&gt; Chain 4: Iteration:  4000 / 20000 [ 20%]  (Warmup)</span>
<span class="co">#&gt; Chain 4: Iteration:  6000 / 20000 [ 30%]  (Warmup)</span>
<span class="co">#&gt; Chain 4: Iteration:  8000 / 20000 [ 40%]  (Warmup)</span>
<span class="co">#&gt; Chain 4: Iteration: 10000 / 20000 [ 50%]  (Warmup)</span>
<span class="co">#&gt; Chain 4: Iteration: 12000 / 20000 [ 60%]  (Warmup)</span>
<span class="co">#&gt; Chain 4: Iteration: 14000 / 20000 [ 70%]  (Warmup)</span>
<span class="co">#&gt; Chain 4: Iteration: 16000 / 20000 [ 80%]  (Warmup)</span>
<span class="co">#&gt; Chain 4: Iteration: 16001 / 20000 [ 80%]  (Sampling)</span>
<span class="co">#&gt; Chain 4: Iteration: 18000 / 20000 [ 90%]  (Sampling)</span>
<span class="co">#&gt; Chain 4: Iteration: 20000 / 20000 [100%]  (Sampling)</span>
<span class="co">#&gt; Chain 4: </span>
<span class="co">#&gt; Chain 4:  Elapsed Time: 5.57685 seconds (Warm-up)</span>
<span class="co">#&gt; Chain 4:                0.854702 seconds (Sampling)</span>
<span class="co">#&gt; Chain 4:                6.43155 seconds (Total)</span>
<span class="co">#&gt; Chain 4:</span>
<span class="co">#&gt; Response variable modelled as a nec3param model using a binomial distribution.</span>
</pre></div>
<p>The function shows the progress of the <code>brms</code> fit and returns the usual <code>brms</code> output (with a few other elements added to this list). The function <code><a href="https://rdrr.io/r/graphics/plot.default.html">plot(out$fit)</a></code> can be used to plot the chains and the chain ACF, so we can assess mixing and look for other potential issues with the model fit. Initially <code>bayesnec</code> will attempt to use starting values generated for that type of model fit. It will run the iterations and then test if all chains are valid. If the model does not have valid chains <code>bayesnec</code> with try up to <code>n_tries</code> more times to fit the data using the generated initial values and obtain a successfully fitted model with good mixing. If this still fails to yield a successful and/or well mixed model <code>bayesnec</code> will try up to <code>n_tries</code> more times using the default initial values as generated by <code>brms</code>. If no model is successfully fit an error will be returned indicating the model could not be fit successfully.</p>
<div class="sourceCode" id="cb4"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span>(<span class="kw">out</span><span class="op">$</span><span class="kw">fit</span>)
</pre></div>
<p><img src="man/ignore/example-check-binomial-NEC-1.png" width="700"></p>
<p>In our example, the chains are well mixed and our ACF plot looks good, so we can go ahead and interpret this model. There are a range of <code>brms</code> warnings messages. As long as the chain plots are good and the parameter estimates are reasonable it is generally ok to interpret a model.</p>
<p>The function <code>plot</code> can be used to plot the fitted model. You can also make your own plot from the data included in the returned <code>bayesnecfit</code> object from the call to <code>bnec</code>. Here we use the default plot method from <code>bayesnec</code>.</p>
<div class="sourceCode" id="cb5"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(mfrow = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>, <span class="fl">1</span>))
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span>(<span class="kw">out</span>)
</pre></div>
<p><img src="man/ignore/example-plot-binomial-NEC-1.png" width="700"></p>
<p>Alternatively, we can use the built in <code>brms</code> methods to plot the <code>brms</code> fit directly. For example:</p>
<div class="sourceCode" id="cb6"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="kw"><a href="http://ggplot2.tidyverse.org">ggplot2</a></span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="kw"><a href="http://tidyverse.tidyverse.org">tidyverse</a></span>)
<span class="co">#&gt; ── Attaching packages ─────────────────────────────────────── tidyverse 1.3.0 ──</span>
<span class="co">#&gt; ✔ tibble  3.0.3     ✔ dplyr   1.0.2</span>
<span class="co">#&gt; ✔ tidyr   1.1.2     ✔ stringr 1.4.0</span>
<span class="co">#&gt; ✔ readr   1.3.1     ✔ forcats 0.5.0</span>
<span class="co">#&gt; ✔ purrr   0.3.4</span>
<span class="co">#&gt; ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──</span>
<span class="co">#&gt; ✖ dplyr::filter() masks stats::filter()</span>
<span class="co">#&gt; ✖ dplyr::lag()    masks stats::lag()</span>
<span class="kw">df</span><span class="op">&lt;-</span><span class="kw">out</span><span class="op">$</span><span class="kw">fit</span><span class="op">$</span><span class="kw">data</span> <span class="op">%&gt;%</span> <span class="fu">mutate</span>(prop=<span class="kw">y</span><span class="op">/</span><span class="kw">trials</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span>(<span class="kw">brms</span>::<span class="fu"><a href="https://rdrr.io/pkg/brms/man/conditional_effects.brmsfit.html">conditional_effects</a></span>(<span class="kw">out</span><span class="op">$</span><span class="kw">fit</span>))[[<span class="fl">1</span>]] <span class="op">+</span>
     <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span>(data= <span class="kw">df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(x=<span class="kw">x</span>, y = <span class="kw">prop</span>), inherit.aes = <span class="fl">FALSE</span>)
<span class="co">#&gt; Setting all 'trials' variables to 1 by default if not specified otherwise.</span>
</pre></div>
<p><img src="man/ignore/example-plotbrms-binomial-NEC-1.png" width="700"><img src="man/ignore/example-plotbrms-binomial-NEC-2.png" width="700"></p>
<p>This model fit doesn’t look great. You can see that the error bounds around the fit are far too narrow for this data, suggesting over dispersion of this model (meaning that the data are more variable than this model fit predicts). We discuss this more below.</p>
</div>
<div id="beta-data" class="section level3">
<h3 class="hasAnchor">
<a href="#beta-data" class="anchor"></a>Beta data</h3>
<p>Sometimes the response variable is distributed between <code>0</code> and <code>1</code> but is not a straight forward binomial. A common example in coral ecology is maximum quantum yield (the proportion of light used for photosynthesis when all reaction centres are open) which is a measure of photosynthetic efficiency calculated from PAM data. Here we have a proportion value that is not based on trials and successes. In this case there are no theoretical ‘trials’ and the data must be modelled using a beta distribution.</p>
<div class="sourceCode" id="cb7"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/base/library.html">require</a></span>(<span class="kw"><a href="http://tidyverse.tidyverse.org">tidyverse</a></span>)
<span class="kw">prop.data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.table</a></span>(<span class="st">"https://pastebin.com/raw/123jq46d"</span>, header = <span class="fl">TRUE</span>, dec = <span class="st">","</span>) <span class="op">%&gt;%</span>
  <span class="fu">mutate</span>(
    raw.x = <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span>(<span class="kw">raw.x</span>)) <span class="op">+</span> <span class="fl">1</span>),
    resp = <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span>(<span class="kw">resp</span>))
  )
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="fl">333</span>)
<span class="kw">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bnec.html">bnec</a></span>(
  data = <span class="kw">prop.data</span>,
  x_var = <span class="st">"raw.x"</span>,
  y_var = <span class="st">"resp"</span>,
  model = <span class="st">"nec3param"</span>
)
<span class="co">#&gt; Warning: It appears as if you have specified a lower bounded prior on a parameter that has no natural lower bound.</span>
<span class="co">#&gt; If this is really what you want, please specify argument 'lb' of 'set_prior' appropriately.</span>
<span class="co">#&gt; Warning occurred for prior </span>
<span class="co">#&gt; b_beta ~ gamma(0.5, 2)</span>
<span class="co">#&gt; b_top ~ beta(5, 1)</span>
<span class="co">#&gt; b_nec ~ gamma(2, 1.05702947974578)</span>
<span class="co">#&gt; Warning: It appears as if you have specified an upper bounded prior on a parameter that has no natural upper bound.</span>
<span class="co">#&gt; If this is really what you want, please specify argument 'ub' of 'set_prior' appropriately.</span>
<span class="co">#&gt; Warning occurred for prior </span>
<span class="co">#&gt; b_top ~ beta(5, 1)</span>
<span class="co">#&gt; Compiling Stan program...</span>
<span class="co">#&gt; Start sampling</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; SAMPLING FOR MODEL '6903135230a6b818174962a7b50f698a' NOW (CHAIN 1).</span>
<span class="co">#&gt; Chain 1: </span>
<span class="co">#&gt; Chain 1: Gradient evaluation took 0.000128 seconds</span>
<span class="co">#&gt; Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 1.28 seconds.</span>
<span class="co">#&gt; Chain 1: Adjust your expectations accordingly!</span>
<span class="co">#&gt; Chain 1: </span>
<span class="co">#&gt; Chain 1: </span>
<span class="co">#&gt; Chain 1: Iteration:     1 / 20000 [  0%]  (Warmup)</span>
<span class="co">#&gt; Chain 1: Iteration:  2000 / 20000 [ 10%]  (Warmup)</span>
<span class="co">#&gt; Chain 1: Iteration:  4000 / 20000 [ 20%]  (Warmup)</span>
<span class="co">#&gt; Chain 1: Iteration:  6000 / 20000 [ 30%]  (Warmup)</span>
<span class="co">#&gt; Chain 1: Iteration:  8000 / 20000 [ 40%]  (Warmup)</span>
<span class="co">#&gt; Chain 1: Iteration: 10000 / 20000 [ 50%]  (Warmup)</span>
<span class="co">#&gt; Chain 1: Iteration: 12000 / 20000 [ 60%]  (Warmup)</span>
<span class="co">#&gt; Chain 1: Iteration: 14000 / 20000 [ 70%]  (Warmup)</span>
<span class="co">#&gt; Chain 1: Iteration: 16000 / 20000 [ 80%]  (Warmup)</span>
<span class="co">#&gt; Chain 1: Iteration: 16001 / 20000 [ 80%]  (Sampling)</span>
<span class="co">#&gt; Chain 1: Iteration: 18000 / 20000 [ 90%]  (Sampling)</span>
<span class="co">#&gt; Chain 1: Iteration: 20000 / 20000 [100%]  (Sampling)</span>
<span class="co">#&gt; Chain 1: </span>
<span class="co">#&gt; Chain 1:  Elapsed Time: 14 seconds (Warm-up)</span>
<span class="co">#&gt; Chain 1:                4.73612 seconds (Sampling)</span>
<span class="co">#&gt; Chain 1:                18.7361 seconds (Total)</span>
<span class="co">#&gt; Chain 1: </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; SAMPLING FOR MODEL '6903135230a6b818174962a7b50f698a' NOW (CHAIN 2).</span>
<span class="co">#&gt; Chain 2: </span>
<span class="co">#&gt; Chain 2: Gradient evaluation took 7.8e-05 seconds</span>
<span class="co">#&gt; Chain 2: 1000 transitions using 10 leapfrog steps per transition would take 0.78 seconds.</span>
<span class="co">#&gt; Chain 2: Adjust your expectations accordingly!</span>
<span class="co">#&gt; Chain 2: </span>
<span class="co">#&gt; Chain 2: </span>
<span class="co">#&gt; Chain 2: Iteration:     1 / 20000 [  0%]  (Warmup)</span>
<span class="co">#&gt; Chain 2: Iteration:  2000 / 20000 [ 10%]  (Warmup)</span>
<span class="co">#&gt; Chain 2: Iteration:  4000 / 20000 [ 20%]  (Warmup)</span>
<span class="co">#&gt; Chain 2: Iteration:  6000 / 20000 [ 30%]  (Warmup)</span>
<span class="co">#&gt; Chain 2: Iteration:  8000 / 20000 [ 40%]  (Warmup)</span>
<span class="co">#&gt; Chain 2: Iteration: 10000 / 20000 [ 50%]  (Warmup)</span>
<span class="co">#&gt; Chain 2: Iteration: 12000 / 20000 [ 60%]  (Warmup)</span>
<span class="co">#&gt; Chain 2: Iteration: 14000 / 20000 [ 70%]  (Warmup)</span>
<span class="co">#&gt; Chain 2: Iteration: 16000 / 20000 [ 80%]  (Warmup)</span>
<span class="co">#&gt; Chain 2: Iteration: 16001 / 20000 [ 80%]  (Sampling)</span>
<span class="co">#&gt; Chain 2: Iteration: 18000 / 20000 [ 90%]  (Sampling)</span>
<span class="co">#&gt; Chain 2: Iteration: 20000 / 20000 [100%]  (Sampling)</span>
<span class="co">#&gt; Chain 2: </span>
<span class="co">#&gt; Chain 2:  Elapsed Time: 13.4786 seconds (Warm-up)</span>
<span class="co">#&gt; Chain 2:                4.76068 seconds (Sampling)</span>
<span class="co">#&gt; Chain 2:                18.2393 seconds (Total)</span>
<span class="co">#&gt; Chain 2: </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; SAMPLING FOR MODEL '6903135230a6b818174962a7b50f698a' NOW (CHAIN 3).</span>
<span class="co">#&gt; Chain 3: </span>
<span class="co">#&gt; Chain 3: Gradient evaluation took 7.5e-05 seconds</span>
<span class="co">#&gt; Chain 3: 1000 transitions using 10 leapfrog steps per transition would take 0.75 seconds.</span>
<span class="co">#&gt; Chain 3: Adjust your expectations accordingly!</span>
<span class="co">#&gt; Chain 3: </span>
<span class="co">#&gt; Chain 3: </span>
<span class="co">#&gt; Chain 3: Iteration:     1 / 20000 [  0%]  (Warmup)</span>
<span class="co">#&gt; Chain 3: Iteration:  2000 / 20000 [ 10%]  (Warmup)</span>
<span class="co">#&gt; Chain 3: Iteration:  4000 / 20000 [ 20%]  (Warmup)</span>
<span class="co">#&gt; Chain 3: Iteration:  6000 / 20000 [ 30%]  (Warmup)</span>
<span class="co">#&gt; Chain 3: Iteration:  8000 / 20000 [ 40%]  (Warmup)</span>
<span class="co">#&gt; Chain 3: Iteration: 10000 / 20000 [ 50%]  (Warmup)</span>
<span class="co">#&gt; Chain 3: Iteration: 12000 / 20000 [ 60%]  (Warmup)</span>
<span class="co">#&gt; Chain 3: Iteration: 14000 / 20000 [ 70%]  (Warmup)</span>
<span class="co">#&gt; Chain 3: Iteration: 16000 / 20000 [ 80%]  (Warmup)</span>
<span class="co">#&gt; Chain 3: Iteration: 16001 / 20000 [ 80%]  (Sampling)</span>
<span class="co">#&gt; Chain 3: Iteration: 18000 / 20000 [ 90%]  (Sampling)</span>
<span class="co">#&gt; Chain 3: Iteration: 20000 / 20000 [100%]  (Sampling)</span>
<span class="co">#&gt; Chain 3: </span>
<span class="co">#&gt; Chain 3:  Elapsed Time: 13.6586 seconds (Warm-up)</span>
<span class="co">#&gt; Chain 3:                4.45521 seconds (Sampling)</span>
<span class="co">#&gt; Chain 3:                18.1138 seconds (Total)</span>
<span class="co">#&gt; Chain 3: </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; SAMPLING FOR MODEL '6903135230a6b818174962a7b50f698a' NOW (CHAIN 4).</span>
<span class="co">#&gt; Chain 4: </span>
<span class="co">#&gt; Chain 4: Gradient evaluation took 7.7e-05 seconds</span>
<span class="co">#&gt; Chain 4: 1000 transitions using 10 leapfrog steps per transition would take 0.77 seconds.</span>
<span class="co">#&gt; Chain 4: Adjust your expectations accordingly!</span>
<span class="co">#&gt; Chain 4: </span>
<span class="co">#&gt; Chain 4: </span>
<span class="co">#&gt; Chain 4: Iteration:     1 / 20000 [  0%]  (Warmup)</span>
<span class="co">#&gt; Chain 4: Iteration:  2000 / 20000 [ 10%]  (Warmup)</span>
<span class="co">#&gt; Chain 4: Iteration:  4000 / 20000 [ 20%]  (Warmup)</span>
<span class="co">#&gt; Chain 4: Iteration:  6000 / 20000 [ 30%]  (Warmup)</span>
<span class="co">#&gt; Chain 4: Iteration:  8000 / 20000 [ 40%]  (Warmup)</span>
<span class="co">#&gt; Chain 4: Iteration: 10000 / 20000 [ 50%]  (Warmup)</span>
<span class="co">#&gt; Chain 4: Iteration: 12000 / 20000 [ 60%]  (Warmup)</span>
<span class="co">#&gt; Chain 4: Iteration: 14000 / 20000 [ 70%]  (Warmup)</span>
<span class="co">#&gt; Chain 4: Iteration: 16000 / 20000 [ 80%]  (Warmup)</span>
<span class="co">#&gt; Chain 4: Iteration: 16001 / 20000 [ 80%]  (Sampling)</span>
<span class="co">#&gt; Chain 4: Iteration: 18000 / 20000 [ 90%]  (Sampling)</span>
<span class="co">#&gt; Chain 4: Iteration: 20000 / 20000 [100%]  (Sampling)</span>
<span class="co">#&gt; Chain 4: </span>
<span class="co">#&gt; Chain 4:  Elapsed Time: 13.7794 seconds (Warm-up)</span>
<span class="co">#&gt; Chain 4:                4.47816 seconds (Sampling)</span>
<span class="co">#&gt; Chain 4:                18.2575 seconds (Total)</span>
<span class="co">#&gt; Chain 4:</span>
<span class="co">#&gt; Warning: </span>
<span class="co">#&gt; 2 (1.2%) p_waic estimates greater than 0.4. We recommend trying loo instead.</span>
<span class="co">#&gt; Response variable modelled as a nec3param model using a beta distribution.</span>
</pre></div>
<div class="sourceCode" id="cb8"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span>(<span class="kw">out</span><span class="op">$</span><span class="kw">fit</span>)
</pre></div>
<p><img src="man/ignore/example-check-beta-NEC-1.png" width="700"></p>
<div class="sourceCode" id="cb9"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(mfrow = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>, <span class="fl">1</span>))
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span>(<span class="kw">out</span>)
</pre></div>
<p><img src="man/ignore/example-plot-beta-NEC-1.png" width="700"></p>
</div>
<div id="poisson-data" class="section level3">
<h3 class="hasAnchor">
<a href="#poisson-data" class="anchor"></a>Poisson data</h3>
<p>Where data are a count (of, for example, individuals or cells) y is poisson. Such data are distributed from <code>0</code> to <code>Inf</code> and are integers. First we read in the count data example from pastebin, and then plot the “concentration” or x data, Again, this is raw.x, and distributed as in our binomial example above.</p>
<div class="sourceCode" id="cb10"><pre class="downlit">
<span class="kw">count.data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.table</a></span>(<span class="st">"https://pastebin.com/raw/ENgNSgf7"</span>, header = <span class="fl">TRUE</span>, dec = <span class="st">","</span>)
<span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span>(<span class="kw">count.data</span>)
<span class="co">#&gt; 'data.frame':    48 obs. of  2 variables:</span>
<span class="co">#&gt;  $ raw.x: chr  "0.1" "0.1" "0.1" "0.1" ...</span>
<span class="co">#&gt;  $ count: int  164 100 103 102 102 101 131 102 112 100 ...</span>

<span class="kw">count.data</span><span class="op">$</span><span class="kw">raw.x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span>(<span class="kw">count.data</span><span class="op">$</span><span class="kw">raw.x</span>))

<span class="fu"><a href="https://rdrr.io/r/base/range.html">range</a></span>(<span class="kw">count.data</span><span class="op">$</span><span class="kw">raw.x</span>)
<span class="co">#&gt; [1]   0.1 190.0</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(mfrow = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">2</span>, <span class="fl">1</span>))
<span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span>(<span class="kw">count.data</span><span class="op">$</span><span class="kw">raw.x</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span>(<span class="kw">count.data</span><span class="op">$</span><span class="kw">count</span>)
</pre></div>
<p><img src="man/ignore/example-get-poisson-data-1.png" width="700"></p>
<p>First we supply <code>bnec</code> with <code>data</code> (count.data), and specify <code>x_var</code> and <code>y_var</code>. As we have concentration data, our <code>x_type</code> would be the gamma distribution, and <code>y_type</code> is “poisson”. The default behaviour to guess the variable types works for this example.</p>
<div class="sourceCode" id="cb11"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="fl">333</span>)
<span class="kw">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bnec.html">bnec</a></span>(
  data = <span class="kw">count.data</span>,
  x_var = <span class="st">"raw.x"</span>,
  y_var = <span class="st">"count"</span>,
  model = <span class="st">"nec3param"</span>
)
<span class="co">#&gt; Compiling Stan program...</span>
<span class="co">#&gt; Start sampling</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; SAMPLING FOR MODEL '7b7ca65d04c0d0109b32f593e92cb5df' NOW (CHAIN 1).</span>
<span class="co">#&gt; Chain 1: </span>
<span class="co">#&gt; Chain 1: Gradient evaluation took 5.8e-05 seconds</span>
<span class="co">#&gt; Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 0.58 seconds.</span>
<span class="co">#&gt; Chain 1: Adjust your expectations accordingly!</span>
<span class="co">#&gt; Chain 1: </span>
<span class="co">#&gt; Chain 1: </span>
<span class="co">#&gt; Chain 1: Iteration:     1 / 20000 [  0%]  (Warmup)</span>
<span class="co">#&gt; Chain 1: Iteration:  2000 / 20000 [ 10%]  (Warmup)</span>
<span class="co">#&gt; Chain 1: Iteration:  4000 / 20000 [ 20%]  (Warmup)</span>
<span class="co">#&gt; Chain 1: Iteration:  6000 / 20000 [ 30%]  (Warmup)</span>
<span class="co">#&gt; Chain 1: Iteration:  8000 / 20000 [ 40%]  (Warmup)</span>
<span class="co">#&gt; Chain 1: Iteration: 10000 / 20000 [ 50%]  (Warmup)</span>
<span class="co">#&gt; Chain 1: Iteration: 12000 / 20000 [ 60%]  (Warmup)</span>
<span class="co">#&gt; Chain 1: Iteration: 14000 / 20000 [ 70%]  (Warmup)</span>
<span class="co">#&gt; Chain 1: Iteration: 16000 / 20000 [ 80%]  (Warmup)</span>
<span class="co">#&gt; Chain 1: Iteration: 16001 / 20000 [ 80%]  (Sampling)</span>
<span class="co">#&gt; Chain 1: Iteration: 18000 / 20000 [ 90%]  (Sampling)</span>
<span class="co">#&gt; Chain 1: Iteration: 20000 / 20000 [100%]  (Sampling)</span>
<span class="co">#&gt; Chain 1: </span>
<span class="co">#&gt; Chain 1:  Elapsed Time: 2.53473 seconds (Warm-up)</span>
<span class="co">#&gt; Chain 1:                0.433583 seconds (Sampling)</span>
<span class="co">#&gt; Chain 1:                2.96831 seconds (Total)</span>
<span class="co">#&gt; Chain 1: </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; SAMPLING FOR MODEL '7b7ca65d04c0d0109b32f593e92cb5df' NOW (CHAIN 2).</span>
<span class="co">#&gt; Chain 2: </span>
<span class="co">#&gt; Chain 2: Gradient evaluation took 2.6e-05 seconds</span>
<span class="co">#&gt; Chain 2: 1000 transitions using 10 leapfrog steps per transition would take 0.26 seconds.</span>
<span class="co">#&gt; Chain 2: Adjust your expectations accordingly!</span>
<span class="co">#&gt; Chain 2: </span>
<span class="co">#&gt; Chain 2: </span>
<span class="co">#&gt; Chain 2: Iteration:     1 / 20000 [  0%]  (Warmup)</span>
<span class="co">#&gt; Chain 2: Iteration:  2000 / 20000 [ 10%]  (Warmup)</span>
<span class="co">#&gt; Chain 2: Iteration:  4000 / 20000 [ 20%]  (Warmup)</span>
<span class="co">#&gt; Chain 2: Iteration:  6000 / 20000 [ 30%]  (Warmup)</span>
<span class="co">#&gt; Chain 2: Iteration:  8000 / 20000 [ 40%]  (Warmup)</span>
<span class="co">#&gt; Chain 2: Iteration: 10000 / 20000 [ 50%]  (Warmup)</span>
<span class="co">#&gt; Chain 2: Iteration: 12000 / 20000 [ 60%]  (Warmup)</span>
<span class="co">#&gt; Chain 2: Iteration: 14000 / 20000 [ 70%]  (Warmup)</span>
<span class="co">#&gt; Chain 2: Iteration: 16000 / 20000 [ 80%]  (Warmup)</span>
<span class="co">#&gt; Chain 2: Iteration: 16001 / 20000 [ 80%]  (Sampling)</span>
<span class="co">#&gt; Chain 2: Iteration: 18000 / 20000 [ 90%]  (Sampling)</span>
<span class="co">#&gt; Chain 2: Iteration: 20000 / 20000 [100%]  (Sampling)</span>
<span class="co">#&gt; Chain 2: </span>
<span class="co">#&gt; Chain 2:  Elapsed Time: 2.39908 seconds (Warm-up)</span>
<span class="co">#&gt; Chain 2:                0.425484 seconds (Sampling)</span>
<span class="co">#&gt; Chain 2:                2.82456 seconds (Total)</span>
<span class="co">#&gt; Chain 2: </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; SAMPLING FOR MODEL '7b7ca65d04c0d0109b32f593e92cb5df' NOW (CHAIN 3).</span>
<span class="co">#&gt; Chain 3: </span>
<span class="co">#&gt; Chain 3: Gradient evaluation took 2.4e-05 seconds</span>
<span class="co">#&gt; Chain 3: 1000 transitions using 10 leapfrog steps per transition would take 0.24 seconds.</span>
<span class="co">#&gt; Chain 3: Adjust your expectations accordingly!</span>
<span class="co">#&gt; Chain 3: </span>
<span class="co">#&gt; Chain 3: </span>
<span class="co">#&gt; Chain 3: Iteration:     1 / 20000 [  0%]  (Warmup)</span>
<span class="co">#&gt; Chain 3: Iteration:  2000 / 20000 [ 10%]  (Warmup)</span>
<span class="co">#&gt; Chain 3: Iteration:  4000 / 20000 [ 20%]  (Warmup)</span>
<span class="co">#&gt; Chain 3: Iteration:  6000 / 20000 [ 30%]  (Warmup)</span>
<span class="co">#&gt; Chain 3: Iteration:  8000 / 20000 [ 40%]  (Warmup)</span>
<span class="co">#&gt; Chain 3: Iteration: 10000 / 20000 [ 50%]  (Warmup)</span>
<span class="co">#&gt; Chain 3: Iteration: 12000 / 20000 [ 60%]  (Warmup)</span>
<span class="co">#&gt; Chain 3: Iteration: 14000 / 20000 [ 70%]  (Warmup)</span>
<span class="co">#&gt; Chain 3: Iteration: 16000 / 20000 [ 80%]  (Warmup)</span>
<span class="co">#&gt; Chain 3: Iteration: 16001 / 20000 [ 80%]  (Sampling)</span>
<span class="co">#&gt; Chain 3: Iteration: 18000 / 20000 [ 90%]  (Sampling)</span>
<span class="co">#&gt; Chain 3: Iteration: 20000 / 20000 [100%]  (Sampling)</span>
<span class="co">#&gt; Chain 3: </span>
<span class="co">#&gt; Chain 3:  Elapsed Time: 2.87607 seconds (Warm-up)</span>
<span class="co">#&gt; Chain 3:                0.585088 seconds (Sampling)</span>
<span class="co">#&gt; Chain 3:                3.46116 seconds (Total)</span>
<span class="co">#&gt; Chain 3: </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; SAMPLING FOR MODEL '7b7ca65d04c0d0109b32f593e92cb5df' NOW (CHAIN 4).</span>
<span class="co">#&gt; Chain 4: </span>
<span class="co">#&gt; Chain 4: Gradient evaluation took 2.2e-05 seconds</span>
<span class="co">#&gt; Chain 4: 1000 transitions using 10 leapfrog steps per transition would take 0.22 seconds.</span>
<span class="co">#&gt; Chain 4: Adjust your expectations accordingly!</span>
<span class="co">#&gt; Chain 4: </span>
<span class="co">#&gt; Chain 4: </span>
<span class="co">#&gt; Chain 4: Iteration:     1 / 20000 [  0%]  (Warmup)</span>
<span class="co">#&gt; Chain 4: Iteration:  2000 / 20000 [ 10%]  (Warmup)</span>
<span class="co">#&gt; Chain 4: Iteration:  4000 / 20000 [ 20%]  (Warmup)</span>
<span class="co">#&gt; Chain 4: Iteration:  6000 / 20000 [ 30%]  (Warmup)</span>
<span class="co">#&gt; Chain 4: Iteration:  8000 / 20000 [ 40%]  (Warmup)</span>
<span class="co">#&gt; Chain 4: Iteration: 10000 / 20000 [ 50%]  (Warmup)</span>
<span class="co">#&gt; Chain 4: Iteration: 12000 / 20000 [ 60%]  (Warmup)</span>
<span class="co">#&gt; Chain 4: Iteration: 14000 / 20000 [ 70%]  (Warmup)</span>
<span class="co">#&gt; Chain 4: Iteration: 16000 / 20000 [ 80%]  (Warmup)</span>
<span class="co">#&gt; Chain 4: Iteration: 16001 / 20000 [ 80%]  (Sampling)</span>
<span class="co">#&gt; Chain 4: Iteration: 18000 / 20000 [ 90%]  (Sampling)</span>
<span class="co">#&gt; Chain 4: Iteration: 20000 / 20000 [100%]  (Sampling)</span>
<span class="co">#&gt; Chain 4: </span>
<span class="co">#&gt; Chain 4:  Elapsed Time: 2.2461 seconds (Warm-up)</span>
<span class="co">#&gt; Chain 4:                0.478025 seconds (Sampling)</span>
<span class="co">#&gt; Chain 4:                2.72413 seconds (Total)</span>
<span class="co">#&gt; Chain 4:</span>
<span class="co">#&gt; Response variable modelled as a nec3param model using a poisson distribution.</span>
</pre></div>
<p>We first plot the model chains and parameter estimates to check the fit.</p>
<div class="sourceCode" id="cb12"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span>(<span class="kw">out</span><span class="op">$</span><span class="kw">fit</span>)
</pre></div>
<p><img src="man/ignore/example-check-poisson-NEC-1.png" width="700"></p>
<div class="sourceCode" id="cb13"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(mfrow = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>, <span class="fl">1</span>))
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span>(<span class="kw">out</span>)
</pre></div>
<p><img src="man/ignore/example-plot-poisson-NEC-1.png" width="700"></p>
</div>
<div id="measure-data" class="section level3">
<h3 class="hasAnchor">
<a href="#measure-data" class="anchor"></a>Measure data</h3>
<p>Where data are a measured variable (ie length or size) y is gamma. Such data are distributed from <code>0+</code> to <code>Inf</code> and are continuous. First we read in the count data example from pastebin, and then plot the “concentration” or x data, Again, this is raw.x, and distributed as in our binomial example above.</p>
<div class="sourceCode" id="cb14"><pre class="downlit">
<span class="kw">measure.data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.table</a></span>(<span class="st">"https://pastebin.com/raw/pWeS6x0n"</span>, header = <span class="fl">TRUE</span>, dec = <span class="st">","</span>)
<span class="kw">measure.data</span><span class="op">$</span><span class="kw">raw.x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span>(<span class="kw">measure.data</span><span class="op">$</span><span class="kw">raw.x</span>))
<span class="kw">measure.data</span><span class="op">$</span><span class="kw">measure</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span>(<span class="kw">measure.data</span><span class="op">$</span><span class="kw">measure</span>))
</pre></div>
<div class="sourceCode" id="cb15"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="fl">333</span>)
<span class="kw">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bnec.html">bnec</a></span>(
  data = <span class="kw">measure.data</span>,
  x_var = <span class="st">"raw.x"</span>,
  y_var = <span class="st">"measure"</span>,
  model = <span class="st">"nec3param"</span>
)
<span class="co">#&gt; Compiling Stan program...</span>
<span class="co">#&gt; Start sampling</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; SAMPLING FOR MODEL '40348b7736a50da6007b8cf0b24d35a4' NOW (CHAIN 1).</span>
<span class="co">#&gt; Chain 1: </span>
<span class="co">#&gt; Chain 1: Gradient evaluation took 6.2e-05 seconds</span>
<span class="co">#&gt; Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 0.62 seconds.</span>
<span class="co">#&gt; Chain 1: Adjust your expectations accordingly!</span>
<span class="co">#&gt; Chain 1: </span>
<span class="co">#&gt; Chain 1: </span>
<span class="co">#&gt; Chain 1: Iteration:     1 / 20000 [  0%]  (Warmup)</span>
<span class="co">#&gt; Chain 1: Iteration:  2000 / 20000 [ 10%]  (Warmup)</span>
<span class="co">#&gt; Chain 1: Iteration:  4000 / 20000 [ 20%]  (Warmup)</span>
<span class="co">#&gt; Chain 1: Iteration:  6000 / 20000 [ 30%]  (Warmup)</span>
<span class="co">#&gt; Chain 1: Iteration:  8000 / 20000 [ 40%]  (Warmup)</span>
<span class="co">#&gt; Chain 1: Iteration: 10000 / 20000 [ 50%]  (Warmup)</span>
<span class="co">#&gt; Chain 1: Iteration: 12000 / 20000 [ 60%]  (Warmup)</span>
<span class="co">#&gt; Chain 1: Iteration: 14000 / 20000 [ 70%]  (Warmup)</span>
<span class="co">#&gt; Chain 1: Iteration: 16000 / 20000 [ 80%]  (Warmup)</span>
<span class="co">#&gt; Chain 1: Iteration: 16001 / 20000 [ 80%]  (Sampling)</span>
<span class="co">#&gt; Chain 1: Iteration: 18000 / 20000 [ 90%]  (Sampling)</span>
<span class="co">#&gt; Chain 1: Iteration: 20000 / 20000 [100%]  (Sampling)</span>
<span class="co">#&gt; Chain 1: </span>
<span class="co">#&gt; Chain 1:  Elapsed Time: 4.05161 seconds (Warm-up)</span>
<span class="co">#&gt; Chain 1:                0.935651 seconds (Sampling)</span>
<span class="co">#&gt; Chain 1:                4.98726 seconds (Total)</span>
<span class="co">#&gt; Chain 1: </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; SAMPLING FOR MODEL '40348b7736a50da6007b8cf0b24d35a4' NOW (CHAIN 2).</span>
<span class="co">#&gt; Chain 2: </span>
<span class="co">#&gt; Chain 2: Gradient evaluation took 4.2e-05 seconds</span>
<span class="co">#&gt; Chain 2: 1000 transitions using 10 leapfrog steps per transition would take 0.42 seconds.</span>
<span class="co">#&gt; Chain 2: Adjust your expectations accordingly!</span>
<span class="co">#&gt; Chain 2: </span>
<span class="co">#&gt; Chain 2: </span>
<span class="co">#&gt; Chain 2: Iteration:     1 / 20000 [  0%]  (Warmup)</span>
<span class="co">#&gt; Chain 2: Iteration:  2000 / 20000 [ 10%]  (Warmup)</span>
<span class="co">#&gt; Chain 2: Iteration:  4000 / 20000 [ 20%]  (Warmup)</span>
<span class="co">#&gt; Chain 2: Iteration:  6000 / 20000 [ 30%]  (Warmup)</span>
<span class="co">#&gt; Chain 2: Iteration:  8000 / 20000 [ 40%]  (Warmup)</span>
<span class="co">#&gt; Chain 2: Iteration: 10000 / 20000 [ 50%]  (Warmup)</span>
<span class="co">#&gt; Chain 2: Iteration: 12000 / 20000 [ 60%]  (Warmup)</span>
<span class="co">#&gt; Chain 2: Iteration: 14000 / 20000 [ 70%]  (Warmup)</span>
<span class="co">#&gt; Chain 2: Iteration: 16000 / 20000 [ 80%]  (Warmup)</span>
<span class="co">#&gt; Chain 2: Iteration: 16001 / 20000 [ 80%]  (Sampling)</span>
<span class="co">#&gt; Chain 2: Iteration: 18000 / 20000 [ 90%]  (Sampling)</span>
<span class="co">#&gt; Chain 2: Iteration: 20000 / 20000 [100%]  (Sampling)</span>
<span class="co">#&gt; Chain 2: </span>
<span class="co">#&gt; Chain 2:  Elapsed Time: 4.16996 seconds (Warm-up)</span>
<span class="co">#&gt; Chain 2:                0.988455 seconds (Sampling)</span>
<span class="co">#&gt; Chain 2:                5.15842 seconds (Total)</span>
<span class="co">#&gt; Chain 2: </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; SAMPLING FOR MODEL '40348b7736a50da6007b8cf0b24d35a4' NOW (CHAIN 3).</span>
<span class="co">#&gt; Chain 3: </span>
<span class="co">#&gt; Chain 3: Gradient evaluation took 2.5e-05 seconds</span>
<span class="co">#&gt; Chain 3: 1000 transitions using 10 leapfrog steps per transition would take 0.25 seconds.</span>
<span class="co">#&gt; Chain 3: Adjust your expectations accordingly!</span>
<span class="co">#&gt; Chain 3: </span>
<span class="co">#&gt; Chain 3: </span>
<span class="co">#&gt; Chain 3: Iteration:     1 / 20000 [  0%]  (Warmup)</span>
<span class="co">#&gt; Chain 3: Iteration:  2000 / 20000 [ 10%]  (Warmup)</span>
<span class="co">#&gt; Chain 3: Iteration:  4000 / 20000 [ 20%]  (Warmup)</span>
<span class="co">#&gt; Chain 3: Iteration:  6000 / 20000 [ 30%]  (Warmup)</span>
<span class="co">#&gt; Chain 3: Iteration:  8000 / 20000 [ 40%]  (Warmup)</span>
<span class="co">#&gt; Chain 3: Iteration: 10000 / 20000 [ 50%]  (Warmup)</span>
<span class="co">#&gt; Chain 3: Iteration: 12000 / 20000 [ 60%]  (Warmup)</span>
<span class="co">#&gt; Chain 3: Iteration: 14000 / 20000 [ 70%]  (Warmup)</span>
<span class="co">#&gt; Chain 3: Iteration: 16000 / 20000 [ 80%]  (Warmup)</span>
<span class="co">#&gt; Chain 3: Iteration: 16001 / 20000 [ 80%]  (Sampling)</span>
<span class="co">#&gt; Chain 3: Iteration: 18000 / 20000 [ 90%]  (Sampling)</span>
<span class="co">#&gt; Chain 3: Iteration: 20000 / 20000 [100%]  (Sampling)</span>
<span class="co">#&gt; Chain 3: </span>
<span class="co">#&gt; Chain 3:  Elapsed Time: 4.4129 seconds (Warm-up)</span>
<span class="co">#&gt; Chain 3:                0.900956 seconds (Sampling)</span>
<span class="co">#&gt; Chain 3:                5.31386 seconds (Total)</span>
<span class="co">#&gt; Chain 3: </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; SAMPLING FOR MODEL '40348b7736a50da6007b8cf0b24d35a4' NOW (CHAIN 4).</span>
<span class="co">#&gt; Chain 4: </span>
<span class="co">#&gt; Chain 4: Gradient evaluation took 3e-05 seconds</span>
<span class="co">#&gt; Chain 4: 1000 transitions using 10 leapfrog steps per transition would take 0.3 seconds.</span>
<span class="co">#&gt; Chain 4: Adjust your expectations accordingly!</span>
<span class="co">#&gt; Chain 4: </span>
<span class="co">#&gt; Chain 4: </span>
<span class="co">#&gt; Chain 4: Iteration:     1 / 20000 [  0%]  (Warmup)</span>
<span class="co">#&gt; Chain 4: Iteration:  2000 / 20000 [ 10%]  (Warmup)</span>
<span class="co">#&gt; Chain 4: Iteration:  4000 / 20000 [ 20%]  (Warmup)</span>
<span class="co">#&gt; Chain 4: Iteration:  6000 / 20000 [ 30%]  (Warmup)</span>
<span class="co">#&gt; Chain 4: Iteration:  8000 / 20000 [ 40%]  (Warmup)</span>
<span class="co">#&gt; Chain 4: Iteration: 10000 / 20000 [ 50%]  (Warmup)</span>
<span class="co">#&gt; Chain 4: Iteration: 12000 / 20000 [ 60%]  (Warmup)</span>
<span class="co">#&gt; Chain 4: Iteration: 14000 / 20000 [ 70%]  (Warmup)</span>
<span class="co">#&gt; Chain 4: Iteration: 16000 / 20000 [ 80%]  (Warmup)</span>
<span class="co">#&gt; Chain 4: Iteration: 16001 / 20000 [ 80%]  (Sampling)</span>
<span class="co">#&gt; Chain 4: Iteration: 18000 / 20000 [ 90%]  (Sampling)</span>
<span class="co">#&gt; Chain 4: Iteration: 20000 / 20000 [100%]  (Sampling)</span>
<span class="co">#&gt; Chain 4: </span>
<span class="co">#&gt; Chain 4:  Elapsed Time: 4.32905 seconds (Warm-up)</span>
<span class="co">#&gt; Chain 4:                0.955888 seconds (Sampling)</span>
<span class="co">#&gt; Chain 4:                5.28494 seconds (Total)</span>
<span class="co">#&gt; Chain 4:</span>
<span class="co">#&gt; Response variable modelled as a nec3param model using a Gamma distribution.</span>
</pre></div>
<div class="sourceCode" id="cb16"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span>(<span class="kw">out</span><span class="op">$</span><span class="kw">fit</span>)
</pre></div>
<p><img src="man/ignore/example-check-measure-NEC-1.png" width="700"></p>
<p>The function <code>plot</code> can be used to plot the fitted model. The estimated <em>NEC</em> value can be obtained directly from the fitted model object, using <code>out$NEC</code>. EC<em>x</em> estimates can also be obtained from the <em>NEC</em> model fit, using the function <code>ecx</code>. Note these may differ from a typical 4-parameter non-linear model, as the <em>NEC</em> model is a broken stick non-linear regression and will often fall more sharply than a smooth 4-parameter non-linear curve.</p>
<div class="sourceCode" id="cb17"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(mfrow = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>, <span class="fl">1</span>))
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span>(<span class="kw">out</span>)
</pre></div>
<p><img src="man/ignore/example-plot-measure-NEC-1.png" width="700"></p>
<div class="sourceCode" id="cb18"><pre class="downlit">
<span class="fu"><a href="../reference/ecx.html">ecx</a></span>(<span class="kw">out</span>)
<span class="co">#&gt;   ec_10_Q50  ec_10_Q2.5 ec_10_Q97.5 </span>
<span class="co">#&gt;    63.20991    52.18468    71.76396</span>
</pre></div>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Rebecca Fisher, Diego Barneche, Gerard Ricardo, David Fox.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.9000.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
