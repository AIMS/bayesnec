<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>bnec — bnec • bayesnec</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/yeti/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="bnec — bnec" />
<meta property="og:description" content="Fits a variety of NEC models using Bayesian analysis and provides a model averaged predictions based on WAIC model weights" />
<meta property="og:image" content="/logo.png" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">bayesnec</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/example1.html">Single model usage</a>
    </li>
    <li>
      <a href="../articles/example2.html">Multi model usage</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/open-aims/bayesnec/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>bnec</h1>
    <small class="dont-index">Source: <a href='https://github.com/open-aims/bayesnec/blob/master/R/bnec.R'><code>R/bnec.R</code></a></small>
    <div class="hidden name"><code>bnec.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Fits a variety of NEC models using Bayesian analysis and provides a model averaged predictions based on WAIC model weights</p>
    </div>

    <pre class="usage"><span class='fu'>bnec</span>(
  <span class='kw'>data</span>,
  <span class='kw'>x_var</span>,
  <span class='kw'>y_var</span>,
  <span class='kw'>model</span>,
  trials_var = <span class='fl'>NA</span>,
  family = <span class='kw'>NULL</span>,
  <span class='kw'>priors</span>,
  x_range = <span class='fl'>NA</span>,
  precision = <span class='fl'>1000</span>,
  sig_val = <span class='fl'>0.01</span>,
  iter = <span class='fl'>20000</span>,
  warmup = <span class='fu'><a href='https://rdrr.io/r/base/Round.html'>floor</a></span>(<span class='kw'>iter</span><span class='op'>/</span><span class='fl'>5</span>) <span class='op'>*</span> <span class='fl'>4</span>,
  <span class='kw'>inits</span>,
  <span class='kw'>...</span>
)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>data</th>
      <td><p>A <code><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></code> containing the data to use for the model.</p></td>
    </tr>
    <tr>
      <th>x_var</th>
      <td><p>A <code><a href='https://rdrr.io/r/base/character.html'>character</a></code> indicating the column heading containing the concentration (x) variable.</p></td>
    </tr>
    <tr>
      <th>y_var</th>
      <td><p>A <code><a href='https://rdrr.io/r/base/character.html'>character</a></code> indicating the column heading containing the response (y) variable.</p></td>
    </tr>
    <tr>
      <th>model</th>
      <td><p>A <code><a href='https://rdrr.io/r/base/character.html'>character</a></code> vector indicating the model(s) to fit. See Details for more information.</p></td>
    </tr>
    <tr>
      <th>trials_var</th>
      <td><p>The column heading indicating the column for the number of "trials" for binomial response data.
If not supplied, the model may run but will not be the model you intended!</p></td>
    </tr>
    <tr>
      <th>family</th>
      <td><p>Either a <code><a href='https://rdrr.io/r/base/character.html'>character</a></code> string, a function, or an object of class <code><a href='https://rdrr.io/r/stats/family.html'>family</a></code> defining the statistical distribution (family) to use for the y (response) data. See details.</p></td>
    </tr>
    <tr>
      <th>priors</th>
      <td><p>An object of class <code><a href='https://rdrr.io/pkg/brms/man/set_prior.html'>brmsprior</a></code> which specifies user-desired prior distributions of model parameters.
If missing, <code>bnec</code> will figure out a baseline prior for each parameter.</p></td>
    </tr>
    <tr>
      <th>x_range</th>
      <td><p>A range of x values over which to consider extracting ECx.</p></td>
    </tr>
    <tr>
      <th>precision</th>
      <td><p>The length of the x vector used for posterior predictions, and over which to extract ECx values. Large values will be slower but more precise.</p></td>
    </tr>
    <tr>
      <th>sig_val</th>
      <td><p>Probability value to use as the lower quantile to test significance of the predictor posterior values
against the lowest observed concentration (assumed to be the control), to estimate NEC as an interpolated NOEC value from smooth ECx curves.</p></td>
    </tr>
    <tr>
      <th>iter</th>
      <td><p>The number of iterations to be passed to <code><a href='https://rdrr.io/pkg/brms/man/brm.html'>brm</a></code>. Defaults to 2e3 to be consistent with brms defaults.</p></td>
    </tr>
    <tr>
      <th>warmup</th>
      <td><p>A positive integer specifying number of warmup (a.k.a. burnin) iterations. This also specifies the number
of iterations used for stepsize adaptation, so warmup samples should not be used for inference. The number of warmup
should not be larger than "iter" and the default is "floor(iter / 5) * 4".</p></td>
    </tr>
    <tr>
      <th>inits</th>
      <td><p>Optional. Initialisation values. Must be a <code><a href='https://rdrr.io/r/base/list.html'>list</a></code> of "n" names lists, where "n" corresponds to the number of chains, and names correspond to the parameter names of a given model.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Further arguments to <code><a href='https://rdrr.io/pkg/brms/man/brm.html'>brm</a></code> via <code><a href='fit_bayesnec.html'>fit_bayesnec</a></code>.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>If argument model is a single string, then an object of class <code><a href='bayesnecfit-class.html'>bayesnecfit</a></code>; if many strings or a set,
an object of class <code><a href='bayesmanecfit-class.html'>bayesmanecfit</a></code>.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>As some concentration-response data will use zero concentration which can cause numerical estimation issues, a
small offset is added (1 / 10th of the next lowest value) to zero values of concentration where <code>x_var</code> are distributed
on a continuous scale from 0 to infinity, or are bounded to 0, or 1.</p>
<p>The argument <code>family</code> indicates the family to use for the response variable in the <code><a href='https://rdrr.io/pkg/brms/man/brm.html'>brm</a></code> call,
and may currently be "Beta" / Beta / Beta(), "binomial" / binomial / binomial(), "Gamma" / Gamma / Gamma(), "gaussian" / gaussian / gaussian(),
"negbinomial" / negbinomial / negbinomial(), or "poisson" / poisson / poisson(). Notice that families Beta and negbinomial are exported objects
of package <span class="pkg">brms</span>, so the user needs to load <span class="pkg">brms</span> before calling these families.
Other families can be added as required, please raise an <a href='https://github.com/AIMS/bayesnec/issues'>issue</a> on the GitHub development site if your
required family is not currently available.
If not supplied, the appropriate distribution will be guessed based on the characteristics of the input data through <code><a href='check_data.html'>check_data</a></code>. Guesses
include all of the above families but negbinomial because this latter requires knowledge on whether the data is over-dispersed. As explained below in the
Return section, the user can extract the dispersion parameter from a bnec call, and if they so wish, can refit the model using the negbinomial family.</p>
<p>The argument <code>model</code> may be one of "nec3param", "nec4param", "necsigm", "nechorme", "ecx4param", "ecxwb1", "ecxwb2",
"ecxexp", "ecxlin", or "excsigm", in which case a single model of the specified type it fit, and <code>bnec</code> returns a model
object of class <code><a href='bayesnecfit-class.html'>bayesnecfit</a></code>.</p>
<p>If a vector of two or more of the available models is supplied, <code>bnec</code> returns a model object of class <code><a href='bayesmanecfit-class.html'>bayesmanecfit</a></code>
containing model averaged predictions for the supplied models, providing they were successfully fitted.</p>
<p>Model averaging is achieved through a weighted sample of each fitted models posterior predictions, with weights derived
using the <code><a href='https://rdrr.io/pkg/brms/man/loo_model_weights.brmsfit.html'>loo_model_weights</a></code> from <span class="pkg">brms</span>. Individual model fits can be extracted from the <code>mod_fits</code>
element and can be examined individually.</p>
<p><code>model</code> may also be one of "all", meaning all of the available models will be fit;
"ecx" meaning only models excluding a specific NEC step parameter fill be fit; "nec" meaning only models with a specific NEC step
parameter will be fit; or "bot_free" meaning only models without a "bot" parameter (without a bottom plateau) will be fit.</p>
<p>Models are fitted using model formula passed to <span class="pkg">brms</span>.</p>
<p>All models provide an estimate for NEC. For model types with "nec" as a prefix, NEC is directly estimated as parameter "nec"
in the model. Models with "ecx" as a prefix are continuous curve models, typically used for extracting ECx values
from concentration response data. In this instance the NEC value is defined as the concentration at which there is
a user supplied (see <code>sig_val</code>) percentage certainty (based on the Bayesian posterior estimate) that the response
falls below the estimated value of the upper asymptote (top) of the response (i.e. the response value is significantly
lower than that expected in the case of no exposure).
The default value for <code>sig_val</code> is 0.01, which corresponds to an alpha value of 0.01 for a one-sided test of significance.</p>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Rebecca Fisher, Diego Barneche, Gerard Ricardo, David Fox.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.9000.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


